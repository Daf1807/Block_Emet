<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Registro Pedidos - El Misti</title>

<style>
:root{
  --rojo:#9e1c1c;
  --amarillo:#f5b400;
  --bg:#f2f2f2;
}

body{
  font-family:system-ui, Arial;
  margin:0;
  background:var(--bg);
}

/* HEADER */
header{
  background:var(--rojo);
  color:white;
  padding:14px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
}

/* SECCIONES */
section{ padding:12px }

.card{
  background:white;
  border-radius:12px;
  padding:10px;
  margin-bottom:12px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}

h2{
  color:var(--rojo);
  margin:8px 0;
}

/* PLATOS */
.item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:8px 0;
  border-bottom:1px solid #eee;
}

.controls{
  display:flex;
  gap:8px;
  align-items:center;
}

.qty{
  width:35px;
  text-align:center;
  font-weight:bold;
  border:none;
  font-size:16px;
}

/* BOTONES */
button{
  border:none;
  padding:8px 12px;
  border-radius:8px;
  cursor:pointer;
  font-size:16px;
}

.btn{
  background:var(--rojo);
  color:white;
}

.big{
  width:100%;
  padding:14px;
  background:var(--amarillo);
  font-weight:bold;
  font-size:18px;
}

/* PEDIDOS */
.pedido{
  background:white;
  border-left:6px solid var(--rojo);
  padding:10px;
  margin-bottom:10px;
  border-radius:8px;
}

/* GRID PC */
@media(min-width:700px){
  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
  }
}
</style>
</head>

<body>

<header>üçΩÔ∏è EL MISTI - Registro de Pedidos</header>

<section>

<div class="card">
Tipo:
<select id="tipo">
  <option value="mesa">Mesa</option>
  <option value="llevar">Llevar</option>
  <option value="delivery">Delivery</option>
</select>
<br><br>
Mesa / Nombre:
<input id="mesa" style="width:100%">
</div>

<div class="grid">

<div class="card">
<h2>Entradas</h2>
<div id="entradas"></div>
</div>

<div class="card">
<h2>Segundos</h2>
<div id="segundos"></div>
</div>

</div>

<!-- EXTRAS COMIDA -->
<div class="card">
<h2>üç≥ Extras comida</h2>
<div id="extrasComida"></div>
</div>

<!-- ENVASES -->
<div class="card">
<h2>ü•° Envases para llevar</h2>
<div id="envases"></div>
</div>

<!-- DELIVERY -->
<div class="card">
<h2>üöö Delivery</h2>
Costo adicional:
<input type="number" id="deliveryCosto" value="0" min="0" step="0.5" style="width:80px"> soles
</div>

<button class="big" onclick="registrarPedido()">‚úÖ Registrar pedido</button>

<h2>üìã Pedidos del d√≠a</h2>
<div id="listaPedidos"></div>

</section>

<script>
const entradas=["Sopa de s√©mola","Salpic√≥n de pollo","Ceviche mixto","Ensalada"];
const segundos=["Aj√≠ de gallina","Chaufa mixto","Pollo al horno","Milanesa","Pescado frito"];

const extrasComida=[
 {nombre:"Arroz extra",precio:2},
 {nombre:"Presa adicional",precio:5},
 {nombre:"Vaso adicional",precio:1},
 {nombre:"Medio vaso refresco",precio:0.5}
];

const envases=[
 {nombre:"Taper grande",precio:1},
 {nombre:"Taper chico",precio:0.5}
];

let pedidos = JSON.parse(localStorage.getItem("pedidosMisti")) || [];


/* ========= CREAR ITEMS ========= */
function crearItems(lista, cont){
  const div=document.getElementById(cont);

  lista.forEach(i=>{
    const nombre=i.nombre||i;

    div.innerHTML+=`
      <div class="item">
        ${nombre} ${i.precio?`(S/ ${i.precio})`:""}
        <div class="controls">
          <button onclick="cambiar('${nombre}',-1)">-</button>
          <input class="qty" id="${nombre}" value="0" readonly>
          <button onclick="cambiar('${nombre}',1)">+</button>
        </div>
      </div>`;
  });
}

function cambiar(id,n){
  const el=document.getElementById(id);
  let v=parseInt(el.value)+n;
  if(v<0)v=0;
  el.value=v;
}


/* ========= REGISTRAR ========= */
function registrarPedido(){

  let total=0;
  let ent=0, seg=0;

  let detalleEntradas=[];
  let detalleSegundos=[];
  let detalleExtras=[];
  let detalleEnvases=[];

  entradas.forEach(p=>{
    const c=+document.getElementById(p).value;
    if(c>0){
      detalleEntradas.push(`${c} - ${p}`);
      ent+=c;
    }
  });

  segundos.forEach(p=>{
    const c=+document.getElementById(p).value;
    if(c>0){
      detalleSegundos.push(`${c} - ${p}`);
      seg+=c;
    }
  });

  const menus=Math.min(ent,seg);

  total+=menus*13;
  total+=(seg-menus)*10;
  total+=(ent-menus)*5;

  extrasComida.forEach(e=>{
    const c=+document.getElementById(e.nombre).value;
    if(c>0){
      detalleExtras.push(`${c} - ${e.nombre}`);
      total+=c*e.precio;
    }
  });

  envases.forEach(e=>{
    const c=+document.getElementById(e.nombre).value;
    if(c>0){
      detalleEnvases.push(`${c} - ${e.nombre}`);
      total+=c*e.precio;
    }
  });

  const delivery=+deliveryCosto.value;
  total+=delivery;

  pedidos.push({
    tipo:tipo.value,
    mesa:mesa.value,
    detalleEntradas,
    detalleSegundos,
    detalleExtras,
    detalleEnvases,
    delivery,
    total
  });

  guardarHistorial();
  mostrar();
  reset();
}


/* ========= MOSTRAR ========= */
function mostrar(){

  let html="";

  pedidos.forEach((p,i)=>{

    html+=`
    <div class="pedido">

      <b>#${i+1} | ${p.tipo.toUpperCase()} | ${p.mesa||"-"}</b>
      <button onclick="eliminar(${i})" style="float:right">üóëÔ∏è</button>
      <br><br>
    `;

    if(p.detalleEntradas.length)
      html+=`<b>Entradas:</b><br>${p.detalleEntradas.join("<br>")}<br><br>`;

    if(p.detalleSegundos.length)
      html+=`<b>Segundos:</b><br>${p.detalleSegundos.join("<br>")}<br><br>`;

    if(p.detalleExtras.length)
      html+=`<b>Extras:</b><br>${p.detalleExtras.join("<br>")}<br><br>`;

    if(p.detalleEnvases.length)
      html+=`<b>Envases:</b><br>${p.detalleEnvases.join("<br>")}<br><br>`;

    if(p.delivery>0)
      html+=`<b>Delivery:</b> S/ ${p.delivery}<br><br>`;

    html+=`<b>Total: S/ ${p.total.toFixed(2)}</b></div>`;
  });

  listaPedidos.innerHTML=html;
}


/* ========= ELIMINAR ========= */
function eliminar(index){
  if(confirm("¬øEliminar este pedido?")){
    pedidos.splice(index,1);
    guardarHistorial();
    mostrar();
  }
}


/* ========= HISTORIAL ========= */
function guardarHistorial(){
  localStorage.setItem("pedidosMisti", JSON.stringify(pedidos));
}

function limpiarHistorial(){
  if(confirm("¬øBorrar TODO el historial del d√≠a?")){
    pedidos=[];
    localStorage.removeItem("pedidosMisti");
    mostrar();
  }
}


/* ========= RESET ========= */
function reset(){
  document.querySelectorAll(".qty").forEach(e=>e.value=0);
  deliveryCosto.value=0;
  mesa.value="";
}


/* INIT */
crearItems(entradas,"entradas");
crearItems(segundos,"segundos");
crearItems(extrasComida,"extrasComida");
crearItems(envases,"envases");

mostrar();
</script>



</body>
</html>
